@startuml
title BeraChef_V1 시퀀스 다이어그램

actor User
participant "BeraChef_V1" as BC
participant "RewardVault_V1" as RV
participant "ERC20" as E

note over User, BC
  상황: BeraChef_V1 초기화 시
  목적: BeraChef_V1 시스템 설정
end note

User -> BC: constructor(rewardVault)
activate BC
BC -> BC: _setRewardVault(rewardVault)
deactivate BC

note over User, BC
  상황: 풀 추가 시
  목적: 새로운 스테이킹 풀 생성
end note

User -> BC: addPool(lpToken, allocPoint, lockDuration)
activate BC
BC -> BC: _addPool(lpToken, allocPoint, lockDuration)
note right: 풀 추가 및 할당 포인트, 잠금 기간 설정
deactivate BC

note over User, BC
  상황: 보상 분배 시
  목적: 보상 토큰 분배
end note

User -> BC: distributeRewards()
activate BC
BC -> RV: distributeRewards()
activate RV
RV --> BC: distributed
deactivate RV
deactivate BC

note over User, BC
  상황: 스테이킹 시
  목적: LP 토큰 스테이킹
end note

User -> BC: stake(poolId, amount)
activate BC
BC -> E: transferFrom(msg.sender, address(this), amount)
activate E
E --> BC: transferred
deactivate E

BC -> BC: _stake(poolId, amount)
note right: LP 토큰 스테이킹
deactivate BC

note over User, BC
  상황: 언스테이킹 시
  목적: LP 토큰 언스테이킹
end note

User -> BC: unstake(poolId, amount)
activate BC
BC -> BC: _unstake(poolId, amount)
note right: LP 토큰 언스테이킹
deactivate BC

note over User, BC
  상황: 보상 청구 시
  목적: 보상 토큰 청구
end note

User -> BC: claimRewards(poolId)
activate BC
BC -> RV: claimRewards(poolId)
activate RV
RV --> BC: claimed
deactivate RV
deactivate BC

@enduml 
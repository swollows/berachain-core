@startuml
title 배포 및 초기화 시퀀스 다이어그램

actor Deployer
participant "POLDeployer" as PD
participant "BeraChef" as BC
participant "BlockRewardController" as BRC
participant "Distributor" as D
participant "RewardVaultFactory" as RVF
participant "BGTFeeDeployer" as BFD
participant "BGTStaker" as BGS
participant "FeeCollector" as FC

note over Deployer, PD
  상황: POL 시스템 전체 배포 시
  목적: 모든 컨트랙트 배포 및 초기화
end note

Deployer -> PD: deployPOL()
activate PD

note over PD, BC
  상황: BeraChef 컨트랙트 초기화
  목적: 보상 분배 및 밸리데이터 관리 설정
end note

PD -> BC: initialize(distributor, factory, governance, beaconDeposit, maxWeights)
activate BC
deactivate BC

note over PD, BRC
  상황: BlockRewardController 컨트랙트 초기화
  목적: 블록 보상 관리 시스템 설정
end note

PD -> BRC: initialize(bgt, distributor, beaconDeposit, governance)
activate BRC
deactivate BRC

note over PD, D
  상황: Distributor 컨트랙트 초기화
  목적: 보상 분배 시스템 설정
end note

PD -> D: initialize(beraChef, bgt, blockRewardController, governance, gIndices)
activate D
deactivate D

note over PD, RVF
  상황: RewardVaultFactory 컨트랙트 초기화
  목적: 보상 볼트 생성 및 관리 시스템 설정
end note

PD -> RVF: initialize(bgt, distributor, beaconDeposit, governance, vaultImpl)
activate RVF
deactivate RVF
deactivate PD

note over Deployer, BFD
  상황: BGT 수수료 시스템 배포
  목적: BGT 스테이킹 및 수수료 수집 시스템 설정
end note

Deployer -> BFD: constructor(bgt, governance, rewardToken, salts, payoutAmount)
activate BFD

note over BFD, BGS
  상황: BGTStaker 컨트랙트 초기화
  목적: BGT 스테이킹 시스템 설정
end note

BFD -> BGS: initialize(bgt, feeCollector, governance, rewardToken)
activate BGS
deactivate BGS

note over BFD, FC
  상황: FeeCollector 컨트랙트 초기화
  목적: 수수료 수집 및 분배 시스템 설정
end note

BFD -> FC: initialize(governance, payoutToken, rewardReceiver, payoutAmount)
activate FC
deactivate FC
deactivate BFD

@enduml 
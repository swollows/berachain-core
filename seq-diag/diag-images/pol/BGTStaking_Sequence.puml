@startuml
title BGT 스테이킹 및 수수료 시스템 시퀀스 다이어그램

actor User
participant "BGT" as BGT
participant "BGTStaker" as BGS
participant "FeeCollector" as FC
participant "BGTIncentiveDistributor" as BID

note over User, BGT
  상황: 사용자가 BGT 토큰을 위임하고자 할 때
  목적: BGT 토큰 위임 및 스테이킹
end note

User -> BGT: delegate(delegatee)
activate BGT
BGT -> BGS: stake(account, amount)
activate BGS
BGS -> BGS: _stake(account, amount)
note right: 계정의 스테이킹 금액 업데이트
deactivate BGS
deactivate BGT

note over User, FC
  상황: 사용자가 수수료를 청구하고자 할 때
  목적: 수수료 청구 및 보상 지급
end note

User -> FC: claimFees(recipient, feeTokens)
activate FC
FC -> FC: _validateClaim()
note right: 청구 가능한 수수료 검증
FC -> BGS: notifyRewardAmount(payoutAmount)
activate BGS
BGS -> BGS: _notifyRewardAmount()
note right: 보상 금액 업데이트
deactivate BGS
FC -> FC: _transferFees()
note right: 수수료 전송 처리
deactivate FC

note over User, BID
  상황: 사용자가 인센티브를 청구하고자 할 때
  목적: BGT 인센티브 청구 및 분배
end note

User -> BID: claim(claims)
activate BID
BID -> BID: _validateClaims()
note right: 청구 가능한 인센티브 검증
BID -> BID: _processClaims()
note right: 인센티브 처리 및 분배
deactivate BID

@enduml 